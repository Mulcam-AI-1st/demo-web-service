<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.teamproject.demo.dao.CookingShowDAO">

	<select id="selectAllArticle"
		resultType="CookingShowVO">

            <![CDATA[
            SELECT  cs.idx as idx, 
		            mb.name as authorid, 
		            cd.value as categoryid, 
		            cs.title as title, 
		            cs.contents as contents,
		            cs.imageurl as imageurl,
		            cs.recommendation as recommendation,
		            cs.postdate as postdate,
		            cs.modifydate as modifydate 
            
            FROM jtb_cookingshow_main cs, JTB_CODE cd, JTB_MEMBER mb
            	where cs.categoryid = cd.code
            	  and cd.CATEGORY='diet_division'
            	  and cs.authorid = mb.id
            order by recommendation desc
     
            ]]>
	</select>
	
	
	<update id="updateRecommendation"
		parameterType="String">

            <![CDATA[
            UPDATE  jtb_cookingshow_main
               SET
            	    recommendation = recommendation + 1
		        
             WHERE idx = #{articleId}
     
            ]]>
	</update>
	
	<select id="selectRecommendationById"
		parameterType="String"
		resultType="String">

            <![CDATA[
            SELECT  TO_CHAR(cs.recommendation)  as recommendation
            
             FROM jtb_cookingshow_main cs
            WHERE cs.idx = #{articleId}
 
            ]]>
	</select>
	
	
	<select id="selectArticleById"
		parameterType="String"
		resultType="CookingShowVO">

            <![CDATA[
             SELECT  cs.idx as idx, 
		            mb.name as authorid, 
		            cd.value as categoryid, 
		            cs.title as title, 
		            cs.contents as contents,
		            cs.imageurl as imageurl,
		            cs.recommendation as recommendation,
		            cs.postdate as postdate,
		            cs.modifydate as modifydate 
            
            FROM jtb_cookingshow_main cs, JTB_CODE cd, JTB_MEMBER mb
            	where cs.categoryid = cd.code
            	  and cd.CATEGORY='diet_division'
            	  and cs.authorid = mb.id
           	  	  and cs.idx = #{articleId}
 
            ]]>
	</select>
	
	
	<select id="selectArticleDetailById"
		parameterType="String"
		resultType="CookingShowDetailVO">

            <![CDATA[
            SELECT  *
            
             FROM jtb_cookingshow_detail 
            WHERE idx = #{articleId}
 
            ]]>
	</select>
	
	
	
	<select id="selectArticleCommentsById"
		parameterType="String"
		resultType="CookingShowCommentsVO">

            <![CDATA[
                  SELECT cc.IDX as idx,
					cc.CIDX as cidx,
					mb.name as commenterId,
					cc.comments as comments,
					cc.POSTDATE as postDate,
					cc.MODIFYDATE as modityDate
            
             FROM JTB_COOKINGSHOW_COMMENT cc, JTB_MEMBER mb
            WHERE cc.CommenterID = mb.id
              and cc.idx = #{articleId}
 
            ]]>
	</select>
	





</mapper>